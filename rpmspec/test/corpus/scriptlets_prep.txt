===============================================================================
Prep Section (Empty)
===============================================================================

%prep

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)))

===============================================================================
Prep Section (%setup)
===============================================================================

%prep
%setup -q

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        (macro_option)))))

===============================================================================
Prep Section (%setup with flags)
===============================================================================

%prep
%setup -c -q

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        (macro_option)
        (macro_option)))))

===============================================================================
Prep Section (%setup with source options)
===============================================================================

%prep
%setup -a 0 -b 1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        (macro_option
          (integer))
        (macro_option
          (integer))))))

===============================================================================
Prep Section (%setup with attached source numbers)
===============================================================================

%prep
%setup -a4 -b10

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        (macro_option)
        (macro_option)))))

===============================================================================
Prep Section (%setup with name option)
===============================================================================

%prep
%setup -n custom-directory

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        argument: (macro_option
          directory: (directory
            (identifier)))))))

===============================================================================
Prep Section (%setup complex combination)
===============================================================================

%prep
%setup -c -n %{name} -a 1 -q

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        argument: (macro_option)
        argument: (macro_option
          directory: (directory
            (macro_expansion
              (identifier))))
        argument: (macro_option
          number: (integer))
        argument: (macro_option)))))

===============================================================================
Prep Section (%setup standalone)
===============================================================================

%prep
%setup -D -T

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        (macro_option)
        (macro_option)))))

===============================================================================
Prep Section (%setup edge cases)
===============================================================================

%prep
%setup -C
%setup -a 10 -n "quoted directory name"

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        argument: (macro_option))
      (setup_macro
        (builtin)
        argument: (macro_option
          number: (integer))
        argument: (macro_option
          directory: (quoted_string
            (string_content)))))))

===============================================================================
Prep Section (%setup with combined flags)
===============================================================================

%prep
%setup -qn %{name}-%{version} -D -T -a1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (setup_macro
        (builtin)
        argument: (macro_option
          directory: (directory
            (macro_expansion
              (identifier))
            (macro_expansion
              (identifier))))
        argument: (macro_option)
        argument: (macro_option)
        argument: (macro_option)))))

===============================================================================
Prep Section (%autosetup basic)
===============================================================================

%prep
%autosetup

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)))))

===============================================================================
Prep Section (%autosetup with VCS)
===============================================================================

%prep
%autosetup -S git

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        (macro_option)))))

===============================================================================
Prep Section (%autosetup with options)
===============================================================================

%prep
%autosetup -v -N -p1 -n mydir -S git_am

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        argument: (macro_option)
        argument: (macro_option)
        argument: (macro_option)
        argument: (macro_option
          directory: (directory
            (identifier)))
        argument: (macro_option)))))

===============================================================================
Prep Section (%autosetup with attached source number)
===============================================================================

%prep
%autosetup -a4 -p1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        (macro_option)
        (macro_option)))))

===============================================================================
Prep Section (%autosetup with macro-concatenated directory)
===============================================================================

%prep
%autosetup -n %{crate}-%{version} -p1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        argument: (macro_option
          directory: (directory
            (macro_expansion
              (identifier))
            (macro_expansion
              (identifier))))
        argument: (macro_option)))))

===============================================================================
Prep Section (%autosetup with word-macro directory)
===============================================================================

%prep
%autosetup -n talloc-%{version} -p1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        argument: (macro_option
          directory: (directory
            (identifier)
            (macro_expansion
              (identifier))))
        argument: (macro_option)))))

===============================================================================
Prep Section (%autosetup with dotted version in directory)
===============================================================================

%prep
%autosetup -p1 -n %{pkgname}-%{major}.%{minor} -a1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autosetup_macro
        (builtin)
        argument: (macro_option)
        argument: (macro_option
          directory: (directory
            (macro_expansion
              (identifier))
            (macro_expansion
              (identifier))
            (macro_expansion
              (identifier))))
        argument: (macro_option)))))

===============================================================================
Prep Section (%autopatch basic)
===============================================================================

%prep
%autopatch

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autopatch_macro
        (builtin)))))

===============================================================================
Prep Section (%autopatch with range)
===============================================================================

%prep
%autopatch -m 100 -M 200

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autopatch_macro
        (builtin)
        (macro_option
          (integer))
        (macro_option
          (integer))))))

===============================================================================
Prep Section (%autopatch with macro expression)
===============================================================================

%prep
%autopatch -M %[%{?fedora} * 10 + 9]

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autopatch_macro
        (builtin)
        argument: (macro_option
          value: (macro_expression
            (macro_arithmetic_operator
              left: (macro_arithmetic_operator
                left: (macro_expansion
                  (conditional_expansion
                    condition: (identifier)))
                right: (integer))
              right: (integer))))))))

===============================================================================
Prep Section (%autopatch with arguments)
===============================================================================

%prep
%autopatch 1 4 6

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (autopatch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_argument
          (integer))
        (macro_argument
          (integer))))))

===============================================================================
Prep Section (%patch basic usage)
===============================================================================

%prep
%patch 0
%patch -P 1

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer)))
      (patch_macro
        (builtin)
        (macro_option
          (integer))))))

===============================================================================
Prep Section (%patch with flags)
===============================================================================

%prep
%patch 0 -p 1 -E
%patch 1 -R -Z

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option
          (integer))
        (macro_option))
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option)
        (macro_option)))))

===============================================================================
Prep Section (%patch with string options)
===============================================================================

%prep
%patch 0 -b .orig
%patch -P 1 -o /tmp/output

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option
          (word)))
      (patch_macro
        (builtin)
        (macro_option
          (integer))
        (macro_option
          (word))))))

===============================================================================
Prep Section (%patch complex combination)
===============================================================================

%prep
%patch 0 -p 1 -b .backup -F 2 -E
%patch -P 2 -R -z .old

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option
          (integer))
        (macro_option
          (word))
        (macro_option
          (integer))
        (macro_option))
      (patch_macro
        (builtin)
        (macro_option
          (integer))
        (macro_option)
        (macro_option
          (word))))))

===============================================================================
Prep Section (%patch standalone)
===============================================================================

%prep
%patch 1 -p 1
%patch -P 0 -E

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option
          (integer)))
      (patch_macro
        (builtin)
        (macro_option
          (integer))
        (macro_option)))))

===============================================================================
Prep Section (%patch edge cases)
===============================================================================

%prep
%patch 10 -F 3
%patch -b "backup with spaces" -p 0

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (script_block
      (patch_macro
        (builtin)
        (macro_argument
          (integer))
        (macro_option
          (integer)))
      (patch_macro
        (builtin)
        (macro_option
          (quoted_string
            (string_content)))
        (macro_option
          (integer))))))

===============================================================================
Prep Section (prepend option)
===============================================================================

%prep -p
echo "pre-prep step"

-------------------------------------------------------------------------------

(spec
  (prep_scriptlet
    (section_prep)
    (scriptlet_augment_option)
    (script_block
      (script_line
        (script_content)))))
