===============================================================================
Conditionals (%ifarch)
===============================================================================

%ifarch s390x
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (ifarch_statement
    condition: (arch
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%ifos)
===============================================================================

%ifos linux
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (ifos_statement
    condition: (os
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%ifnarch)
===============================================================================

%ifnarch x86_64
BuildRequires:  magic
%endif

-------------------------------------------------------------------------------

(spec
  (ifarch_statement
    condition: (arch
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with simple macros)
===============================================================================

%if %{defined with_foo}
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (defined_operator
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with complex macros)
===============================================================================

%if %{defined with_foo} && %{undefined with_bar}
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (boolean_operator
      left: (defined_operator
        (identifier))
      right: (defined_operator
        (identifier)))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with string comparison)
===============================================================================

%if "%{optimize_flags}" != "none"
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (comparison_operator
      (quoted_string
        (macro_expansion
          (identifier)))
      (quoted_string
        (quoted_string_content)))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with mathematical comparison)
===============================================================================

%if 0%{?fedora} > 10 || 0%{?rhel} > 7
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (boolean_operator
      left: (comparison_operator
        (concatenation
          (integer)
          (macro_expansion
            (conditional_expansion
              condition: (identifier))))
        (integer))
      right: (comparison_operator
        (concatenation
          (integer)
          (macro_expansion
            (conditional_expansion
              condition: (identifier))))
        (integer)))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with expansion)
===============================================================================

%if 0%{?fedora}
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (concatenation
      (integer)
      (macro_expansion
        (conditional_expansion
          condition: (identifier))))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with paranthesis)
===============================================================================

%if (0%{?fedora} || 0%{?rhel} > 7)
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (parenthesized_expression
      (boolean_operator
        left: (concatenation
          (integer)
          (macro_expansion
            (conditional_expansion
              condition: (identifier))))
        right: (comparison_operator
          (concatenation
            (integer)
            (macro_expansion
              (conditional_expansion
                condition: (identifier))))
          (integer))))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%if with %else)
===============================================================================

%if 0%{?fedora}
BuildRequires:  foo
%else
BuildRequires:  bar
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (concatenation
      (integer)
      (macro_expansion
        (conditional_expansion
          condition: (identifier))))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))
    alternative: (else_clause
      body: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))))

===============================================================================
Conditionals (%if with %elif)
===============================================================================

%if 0%{?fedora}
BuildRequires:  foo
%elif 0%{?rhel}
BuildRequires:  bar
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (concatenation
      (integer)
      (macro_expansion
        (conditional_expansion
          condition: (identifier))))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))
    alternative: (elif_clause
      condition: (concatenation
        (integer)
        (macro_expansion
          (conditional_expansion
            condition: (identifier))))
      consequence: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))))

===============================================================================
Conditionals (%if with %elif and %else)
===============================================================================

%if 0%{?fedora}
BuildRequires:  foo
%elif 0%{?rhel}
BuildRequires:  bar
%else
BuildRequires:  wurst
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (concatenation
      (integer)
      (macro_expansion
        (conditional_expansion
          condition: (identifier))))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))
    alternative: (elif_clause
      condition: (concatenation
        (integer)
        (macro_expansion
          (conditional_expansion
            condition: (identifier))))
      consequence: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))
    alternative: (else_clause
      body: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))))

===============================================================================
Conditionals (Nested %if with %elif and %else)
===============================================================================

%if 0%{?rhel}

%ifarch x86_64
%bcond_without ceph
%bcond_without winexe
%else
%bcond_with ceph
%bcond_with winexe
#endifarch
%endif

%else
%bcond_without ceph
%bcond_without winexe
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (concatenation
      (integer)
      (macro_expansion
        (conditional_expansion
          condition: (identifier))))
    consequence: (ifarch_statement
      condition: (arch
        (identifier))
      consequence: (macro_expansion_call
        (identifier)
        argument: (word))
      consequence: (macro_expansion_call
        (identifier)
        argument: (word))
      alternative: (else_clause
        body: (macro_expansion_call
          (identifier)
          argument: (word))
        body: (macro_expansion_call
          (identifier)
          argument: (word)))
      (comment))
    alternative: (else_clause
      body: (macro_expansion_call
        (identifier)
        argument: (word))
      body: (macro_expansion_call
        (identifier)
        argument: (word)))))

===============================================================================
Conditionals (%if %{with ..})
===============================================================================

%if %{with libwbclient}
Requires(post): libwbclient
%endif

-------------------------------------------------------------------------------

(spec
  (if_statement
    condition: (with_operator
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag
          (qualifier))
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%ifnarch with negation)
===============================================================================

%ifnarch i386 i686
BuildRequires:  foo
%endif

-------------------------------------------------------------------------------

(spec
  (ifarch_statement
    condition: (arch
      (identifier)
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%ifnos with negation)
===============================================================================

%ifnos windows
BuildRequires:  linux-only-package
%endif

-------------------------------------------------------------------------------

(spec
  (ifos_statement
    condition: (os
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%ifarch with macro expressions)
===============================================================================

%ifarch %{ix86} x86_64
BuildRequires:  arch-specific-package
%endif

-------------------------------------------------------------------------------

(spec
  (ifarch_statement
    condition: (arch
      (macro_expansion
        (identifier))
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))))

===============================================================================
Conditionals (%elifarch support)
===============================================================================

%ifarch x86_64
BuildRequires:  x86_64-package
%elifarch aarch64
BuildRequires:  aarch64-package
%else
BuildRequires:  generic-package
%endif

-------------------------------------------------------------------------------

(spec
  (ifarch_statement
    condition: (arch
      (identifier))
    consequence: (preamble
      (tags
        (dependency_tag)
        value: (dependency
          name: (dependency_name
            (word)))))
    alternative: (elifarch_clause
      condition: (word)
      consequence: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))
    alternative: (else_clause
      body: (preamble
        (tags
          (dependency_tag)
          value: (dependency
            name: (dependency_name
              (word))))))))
