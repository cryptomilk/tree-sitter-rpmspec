================================================================================
Simple macro in echo command
================================================================================

echo %{_libdir}

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (rpm_macro_expansion)))

================================================================================
Macro in path
================================================================================

cd %{buildroot}/usr

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (concatenation
      (rpm_macro_expansion)
      (word))))

================================================================================
Nested macro
================================================================================

echo %{dirname:%{SOURCE0}}

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (rpm_macro_expansion
      (rpm_macro_expansion))))

================================================================================
Multiple macros in command
================================================================================

cp %{SOURCE0} %{buildroot}

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (rpm_macro_expansion)
    (rpm_macro_expansion)))

================================================================================
Empty macro braces
================================================================================

echo %{}

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (rpm_macro_expansion)))

================================================================================
Simple macro without braces
================================================================================

echo %version

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (rpm_macro_simple)))

================================================================================
Simple macro in path
================================================================================

cd %buildroot/usr

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (concatenation
      (rpm_macro_simple)
      (word))))

================================================================================
Multiple simple macros
================================================================================

echo %name-%version

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (concatenation
      (rpm_macro_simple)
      (word)
      (rpm_macro_simple))))

================================================================================
Mixed brace and simple macros
================================================================================

echo %{_libdir}/%name

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (concatenation
      (rpm_macro_expansion)
      (word)
      (rpm_macro_simple))))

================================================================================
Printf specifier not a macro (single char)
================================================================================

printf "%s\n" foo

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (string
      (string_content))
    (word)))

================================================================================
Shell expansion with %(cmd)
================================================================================

echo %(uname -r)

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (command_substitution
      (command
        (command_name
          (word))
        (word)))))

================================================================================
Shell expansion with macro inside
================================================================================

echo %(cat %{SOURCE0})

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (command_substitution
      (command
        (command_name
          (word))
        (rpm_macro_expansion)))))

================================================================================
Shell expansion concatenated with path
================================================================================

cd %(pwd)/%{builddir}

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (word))
    (concatenation
      (command_substitution
        (command
          (command_name
            (word))))
      (word)
      (rpm_macro_expansion))))

================================================================================
Global macro definition
================================================================================

%global goroot %{_libdir}/go

--------------------------------------------------------------------------------

(program
  (rpm_global
    (rpm_global_keyword)
    (rpm_macro_name)
    (rpm_macro_body)))

================================================================================
Define macro
================================================================================

%define debug_package %{nil}

--------------------------------------------------------------------------------

(program
  (rpm_define
    (rpm_define_keyword)
    (rpm_macro_name)
    (rpm_macro_body)))

================================================================================
Undefine macro
================================================================================

%undefine _missing_build_ids

--------------------------------------------------------------------------------

(program
  (rpm_undefine
    (rpm_undefine_keyword)
    (rpm_macro_name)))

================================================================================
Mixed definitions and commands
================================================================================

%global builddir build
cd %{builddir}

--------------------------------------------------------------------------------

(program
  (rpm_global
    (rpm_global_keyword)
    (rpm_macro_name)
    (rpm_macro_body))
  (command
    (command_name
      (word))
    (rpm_macro_expansion)))

================================================================================
Define with line continuation
================================================================================

%define long_macro \
  this is a \
  long value
echo done

--------------------------------------------------------------------------------

(program
  (rpm_define
    (rpm_define_keyword)
    (rpm_macro_name)
    (rpm_macro_body))
  (command
    (command_name
      (word))
    (word)))

================================================================================
Global after variable assignment
================================================================================

FOO=bar
%global myvar hello

--------------------------------------------------------------------------------

(program
  (variable_assignment
    (variable_name)
    (word))
  (rpm_global
    (rpm_global_keyword)
    (rpm_macro_name)
    (rpm_macro_body)))

================================================================================
Back-to-back export statements
================================================================================

export A="$(echo hello)"
export B="$(echo world)"

--------------------------------------------------------------------------------

(program
  (declaration_command
    (variable_assignment
      (variable_name)
      (string
        (command_substitution
          (command
            (command_name
              (word))
            (word))))))
  (declaration_command
    (variable_assignment
      (variable_name)
      (string
        (command_substitution
          (command
            (command_name
              (word))
            (word)))))))

================================================================================
Export with comment then another export
================================================================================

# First export
export FOO="bar"
# Second export
export BAZ="qux"

--------------------------------------------------------------------------------

(program
  (comment)
  (declaration_command
    (variable_assignment
      (variable_name)
      (string
        (string_content))))
  (comment)
  (declaration_command
    (variable_assignment
      (variable_name)
      (string
        (string_content)))))

================================================================================
Export followed by simple macro command
================================================================================

export PYTHONARCHDIR=%{python3_sitearch}
%configure --enable-fhs

--------------------------------------------------------------------------------

(program
  (declaration_command
    (variable_assignment
      (variable_name)
      (rpm_macro_expansion)))
  (command
    (command_name
      (rpm_macro_simple))
    (word)))

================================================================================
Simple macro command with line continuation
================================================================================

%configure \
    --enable-fhs \
    --with-piddir=/run

--------------------------------------------------------------------------------

(program
  (command
    (command_name
      (rpm_macro_simple))
    (word)
    (word)))
